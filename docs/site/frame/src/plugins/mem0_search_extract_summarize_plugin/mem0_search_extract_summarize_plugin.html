<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
<meta name="generator" content="pdoc3 0.11.1">
<title>frame.src.plugins.mem0_search_extract_summarize_plugin.mem0_search_extract_summarize_plugin API documentation</title>
<meta name="description" content="Mem0SearchExtractSummarizePlugin …">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/13.0.0/sanitize.min.css" integrity="sha512-y1dtMcuvtTMJc1yPgEqF0ZjQbhnc/bFhyvIyVNb9Zk5mIGtqVaAB1Ttl28su8AvFMOY0EwRbAe+HCLqj6W7/KA==" crossorigin>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/13.0.0/typography.min.css" integrity="sha512-Y1DYSb995BAfxobCkKepB1BqJJTPrOp3zPL74AWFugHHmmdcvO+C48WLrUOlhGMc0QG7AE3f7gmvvcrmX2fDoA==" crossorigin>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:1.5em;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:2em 0 .50em 0}h3{font-size:1.4em;margin:1.6em 0 .7em 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .2s ease-in-out}a:visited{color:#503}a:hover{color:#b62}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900;font-weight:bold}pre code{font-size:.8em;line-height:1.4em;padding:1em;display:block}code{background:#f3f3f3;font-family:"DejaVu Sans Mono",monospace;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em 1em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul ul{padding-left:1em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js" integrity="sha512-D9gUyxqja7hBtkWpPWGt9wfbfaMGVt9gnyCvYa+jojwwPHLCzUm5i8rpk7vD7wNee9bA35eYIjobYPaQuKS1MQ==" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => {
hljs.configure({languages: ['bash', 'css', 'diff', 'graphql', 'ini', 'javascript', 'json', 'plaintext', 'python', 'python-repl', 'rust', 'shell', 'sql', 'typescript', 'xml', 'yaml']});
hljs.highlightAll();
})</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>frame.src.plugins.mem0_search_extract_summarize_plugin.mem0_search_extract_summarize_plugin</code></h1>
</header>
<section id="section-intro">
<p>Mem0SearchExtractSummarizePlugin</p>
<p>This plugin provides a mechanism to search memories, extract relevant information, and generate summarized insights,
functioning as a Retrieval-Augmented Generation (RAG) mechanism. It is automatically included when the
'with-memory' permission is granted to a Framer, ensuring that memory-based responses are comprehensive
and contextually relevant.</p>
<p>The plugin enhances the Framer's ability to provide informed responses by leveraging stored memories
and contextual information. It integrates seamlessly with the Mem0 memory system to facilitate
efficient memory retrieval and summarization.</p>
<p>Key features:
- Memory search based on user queries
- Relevant information extraction from memories
- Summarization of extracted information
- Integration with the Framer's action registry for easy invocation</p>
<p>Note: This plugin might be refactored into a core component in the future to streamline its integration
and usage within the Frame framework.</p>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="frame.src.plugins.mem0_search_extract_summarize_plugin.mem0_search_extract_summarize_plugin.Mem0SearchExtractSummarizePlugin"><code class="flex name class">
<span>class <span class="ident">Mem0SearchExtractSummarizePlugin</span></span>
<span>(</span><span>framer)</span>
</code></dt>
<dd>
<div class="desc"><p>Base class for all Frame plugins.</p>
<p>This class defines the basic structure and interface that all plugins should follow.
Plugins provide a way to extend the functionality of Framer instances.</p>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>framer</code></strong></dt>
<dd>The Framer instance that this plugin is associated with.</dd>
</dl>
<p>Initialize the plugin with a Framer instance.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>framer</code></strong></dt>
<dd>The Framer instance to associate with this plugin.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class Mem0SearchExtractSummarizePlugin(BasePlugin):
    def __init__(self, framer):
        super().__init__(framer)
        self.logger = logging.getLogger(__name__)
        self.logger.setLevel(logging.INFO)
        handler = logging.StreamHandler()
        handler.setFormatter(
            logging.Formatter(
                &#34;%(asctime)s - %(name)s - %(levelname)s - %(funcName)s - %(message)s&#34;
            )
        )
        self.logger.addHandler(handler)
        self.mem0_adapter = Mem0Adapter()

    async def on_load(self, framer) -&gt; None:
        # Check for the correct permission before registering the action
        if &#34;with_mem0_search_extract_summarize_plugin&#34; in framer.permissions:
            api_key = os.getenv(&#34;MEM0_API_KEY&#34;, &#34;&#34;).strip()
            if not api_key:
                api_key = MEM0_API_KEY
            if api_key:
                framer.brain.action_registry.add_action(
                    &#34;respond with memory retrieval&#34;,
                    description=&#34;This action is ideal for responding to personal questions that involve historical or memory-based &#34;
                    &#34;information about the user or the Framer. It leverages the Framer&#39;s memory to retrieve relevant data &#34;
                    &#34;or previously saved texts, providing comprehensive answers or insights based on stored memories. &#34;
                    &#34;When questions reference or relate to past conversations, this action is preferred. It generally &#34;
                    &#34;takes precedence over `think` and `observe` actions, especially for questions. If uncertain whether &#34;
                    &#34;a question can be answered with or without memory, default to this action.&#34;,
                    action_func=self.mem0_search_extract_summarize,
                    priority=8,
                )
                self.logger.info(
                    &#34;Mem0SearchExtractSummarizePlugin registered &#39;respond with memory retrieval&#39; action.&#34;
                )
            else:
                self.logger.warning(
                    &#34;Mem0 API key not found or is empty. Action &#39;response with memory retrieval&#39; will not be registered.&#34;
                )
        else:
            self.logger.info(
                &#34;Mem0SearchExtractSummarizePlugin not loaded due to missing permission.&#34;
            )

    def get_actions(self) -&gt; Dict[str, Any]:
        &#34;&#34;&#34;
        Return a dictionary of actions provided by this plugin.
        &#34;&#34;&#34;
        return {&#34;respond with memory retrieval&#34;: self.mem0_search_extract_summarize}

    async def execute(self, action_name: str, parameters: Dict[str, Any]) -&gt; Any:
        &#34;&#34;&#34;
        Execute a specified action with given parameters.

        Args:
            action_name (str): The name of the action to execute.
            parameters (Dict[str, Any]): Parameters for the action.

        Returns:
            Any: The result of the action execution.
        &#34;&#34;&#34;
        if action_name == &#34;respond with memory retrieval&#34;:
            print(&#34;PARAMS: &#34;, parameters)
            return await self.mem0_search_extract_summarize(**parameters)
        else:
            raise ValueError(f&#34;Action {action_name} not found in plugin.&#34;)

    def filter_search_results(
        self, search_results: List[Dict[str, Any]]
    ) -&gt; List[Dict[str, Any]]:
        &#34;&#34;&#34;
        Filter search results by memory text to remove duplicate results.

        Args:
            search_results (List[Dict[str, Any]]): List of search results.

        Returns:
            List[Dict[str, Any]]: Filtered list of search results.
        &#34;&#34;&#34;
        memory_texts = set()
        filtered_results = []
        for result in search_results:
            if (
                isinstance(result, dict)
                and &#34;content&#34; in result
                and isinstance(result[&#34;content&#34;], dict)
                and &#34;memory&#34; in result[&#34;content&#34;]
            ):
                memory_text = result[&#34;content&#34;][&#34;memory&#34;]
                if memory_text not in memory_texts:
                    memory_texts.add(memory_text)
                    filtered_results.append(result)
        return filtered_results

    async def mem0_search_extract_summarize(
        self,
        execution_context: Optional[ExecutionContext] = None,
        query: str = &#34;&#34;,
        user_id: Optional[str] = None,
        agent_id: Optional[str] = None,
        run_id: Optional[str] = None,
        filters: Optional[Dict[str, Any]] = None,
        model_name: str = &#34;gpt-4o-mini&#34;,
        text_response: Optional[str] = None,
    ) -&gt; str:
        self.logger.info(f&#34;mem0_search_extract_summarize called with query: {query}&#34;)
        if not query:
            self.logger.warning(&#34;Query is empty. Returning default response.&#34;)
            query = &#34;default query&#34;  # Set a default query if none is provided

        if execution_context is None:
            execution_context = self.framer.execution_context

        if not isinstance(execution_context, ExecutionContext):
            self.logger.error(&#34;Execution context is not properly initialized.&#34;)
            return &#34;Execution context is not properly initialized.&#34;

        # Ensure the query is a string
        if not isinstance(query, str):
            query = str(query)
        self.logger.info(f&#34;Searching Mem0 for query: {query}&#34;)

        # Ensure at least one required filter is provided
        if not any([user_id, agent_id, run_id]):
            user_id = &#34;default&#34;

        self.logger.info(
            f&#34;Searching with user_id: {user_id}, agent_id: {agent_id}, run_id: {run_id}&#34;
        )
        search_results = self.mem0_adapter.search(
            query, user_id=user_id, agent_id=agent_id, run_id=run_id, filters=filters
        )
        self.logger.info(f&#34;Found {len(search_results)} results in Mem0&#34;)
        self.logger.debug(f&#34;Search results: {search_results}&#34;)

        if not search_results:
            return Decision(
                action=&#34;respond&#34;,
                parameters={
                    &#34;response&#34;: &#34;I don&#39;t have any specific information about that in my memory. Is there anything else I can help you with?&#34;
                },
                reasoning=&#34;No relevant information found in memory.&#34;,
                confidence=0.5,
                priority=1,
                related_roles=[],
                related_goals=[],
            )

        # Filter search results by memory text (remove same text results)
        search_results = self.filter_search_results(search_results)
        self.logger.debug(f&#34;Filtered search results: {search_results}&#34;)

        context = &#34;\n&#34;.join(
            [
                result[&#34;content&#34;][&#34;memory&#34;]
                for result in search_results
                if isinstance(result, dict)
                and &#34;content&#34; in result
                and isinstance(result[&#34;content&#34;], dict)
                and &#34;memory&#34; in result[&#34;content&#34;]
            ]
        )
        if not context:
            return &#34;No relevant information found in Mem0.&#34;

        summary = await self.summarize(query, context, model_name)

        references = &#34;\n&#34;.join(
            [f&#34;[{i+1}] {result[&#39;id&#39;]}&#34; for i, result in enumerate(search_results)]
        )
        return f&#34;# Answer\n\n{summary}\n\n# References\n\n{references}&#34;

    async def summarize(self, query: str, context: str, model_name: str) -&gt; str:
        prompt = f&#34;&#34;&#34;
        Given the following context and query, provide a comprehensive answer:

        Context:
        {context}

        Query: {query}

        Answer:
        &#34;&#34;&#34;

        response = await self.framer.llm_service.get_completion(
            prompt,
            model=model_name,
            max_tokens=1000,
            temperature=0.5,
        )

        return response.strip()</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="frame.src.framer.brain.plugins.base.BasePlugin" href="../../framer/brain/plugins/base.html#frame.src.framer.brain.plugins.base.BasePlugin">BasePlugin</a></li>
<li>abc.ABC</li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="frame.src.plugins.mem0_search_extract_summarize_plugin.mem0_search_extract_summarize_plugin.Mem0SearchExtractSummarizePlugin.execute"><code class="name flex">
<span>async def <span class="ident">execute</span></span>(<span>self, action_name: str, parameters: Dict[str, Any]) ‑> Any</span>
</code></dt>
<dd>
<div class="desc"><p>Execute a specified action with given parameters.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>action_name</code></strong> :&ensp;<code>str</code></dt>
<dd>The name of the action to execute.</dd>
<dt><strong><code>parameters</code></strong> :&ensp;<code>Dict[str, Any]</code></dt>
<dd>Parameters for the action.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Any</code></dt>
<dd>The result of the action execution.</dd>
</dl></div>
</dd>
<dt id="frame.src.plugins.mem0_search_extract_summarize_plugin.mem0_search_extract_summarize_plugin.Mem0SearchExtractSummarizePlugin.filter_search_results"><code class="name flex">
<span>def <span class="ident">filter_search_results</span></span>(<span>self, search_results: List[Dict[str, Any]]) ‑> List[Dict[str, Any]]</span>
</code></dt>
<dd>
<div class="desc"><p>Filter search results by memory text to remove duplicate results.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>search_results</code></strong> :&ensp;<code>List[Dict[str, Any]]</code></dt>
<dd>List of search results.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>List[Dict[str, Any]]</code></dt>
<dd>Filtered list of search results.</dd>
</dl></div>
</dd>
<dt id="frame.src.plugins.mem0_search_extract_summarize_plugin.mem0_search_extract_summarize_plugin.Mem0SearchExtractSummarizePlugin.get_actions"><code class="name flex">
<span>def <span class="ident">get_actions</span></span>(<span>self) ‑> Dict[str, Any]</span>
</code></dt>
<dd>
<div class="desc"><p>Return a dictionary of actions provided by this plugin.</p></div>
</dd>
<dt id="frame.src.plugins.mem0_search_extract_summarize_plugin.mem0_search_extract_summarize_plugin.Mem0SearchExtractSummarizePlugin.mem0_search_extract_summarize"><code class="name flex">
<span>async def <span class="ident">mem0_search_extract_summarize</span></span>(<span>self, execution_context: Optional[<a title="frame.src.services.context.execution_context_service.ExecutionContext" href="../../services/context/execution_context_service.html#frame.src.services.context.execution_context_service.ExecutionContext">ExecutionContext</a>] = None, query: str = '', user_id: Optional[str] = None, agent_id: Optional[str] = None, run_id: Optional[str] = None, filters: Optional[Dict[str, Any]] = None, model_name: str = 'gpt-4o-mini', text_response: Optional[str] = None) ‑> str</span>
</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="frame.src.plugins.mem0_search_extract_summarize_plugin.mem0_search_extract_summarize_plugin.Mem0SearchExtractSummarizePlugin.summarize"><code class="name flex">
<span>async def <span class="ident">summarize</span></span>(<span>self, query: str, context: str, model_name: str) ‑> str</span>
</code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="frame.src.framer.brain.plugins.base.BasePlugin" href="../../framer/brain/plugins/base.html#frame.src.framer.brain.plugins.base.BasePlugin">BasePlugin</a></b></code>:
<ul class="hlist">
<li><code><a title="frame.src.framer.brain.plugins.base.BasePlugin.add_action" href="../../framer/brain/plugins/base.html#frame.src.framer.brain.plugins.base.BasePlugin.add_action">add_action</a></code></li>
<li><code><a title="frame.src.framer.brain.plugins.base.BasePlugin.on_load" href="../../framer/brain/plugins/base.html#frame.src.framer.brain.plugins.base.BasePlugin.on_load">on_load</a></code></li>
<li><code><a title="frame.src.framer.brain.plugins.base.BasePlugin.remove_action" href="../../framer/brain/plugins/base.html#frame.src.framer.brain.plugins.base.BasePlugin.remove_action">remove_action</a></code></li>
</ul>
</li>
</ul>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="frame.src.plugins.mem0_search_extract_summarize_plugin" href="index.html">frame.src.plugins.mem0_search_extract_summarize_plugin</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="frame.src.plugins.mem0_search_extract_summarize_plugin.mem0_search_extract_summarize_plugin.Mem0SearchExtractSummarizePlugin" href="#frame.src.plugins.mem0_search_extract_summarize_plugin.mem0_search_extract_summarize_plugin.Mem0SearchExtractSummarizePlugin">Mem0SearchExtractSummarizePlugin</a></code></h4>
<ul class="">
<li><code><a title="frame.src.plugins.mem0_search_extract_summarize_plugin.mem0_search_extract_summarize_plugin.Mem0SearchExtractSummarizePlugin.execute" href="#frame.src.plugins.mem0_search_extract_summarize_plugin.mem0_search_extract_summarize_plugin.Mem0SearchExtractSummarizePlugin.execute">execute</a></code></li>
<li><code><a title="frame.src.plugins.mem0_search_extract_summarize_plugin.mem0_search_extract_summarize_plugin.Mem0SearchExtractSummarizePlugin.filter_search_results" href="#frame.src.plugins.mem0_search_extract_summarize_plugin.mem0_search_extract_summarize_plugin.Mem0SearchExtractSummarizePlugin.filter_search_results">filter_search_results</a></code></li>
<li><code><a title="frame.src.plugins.mem0_search_extract_summarize_plugin.mem0_search_extract_summarize_plugin.Mem0SearchExtractSummarizePlugin.get_actions" href="#frame.src.plugins.mem0_search_extract_summarize_plugin.mem0_search_extract_summarize_plugin.Mem0SearchExtractSummarizePlugin.get_actions">get_actions</a></code></li>
<li><code><a title="frame.src.plugins.mem0_search_extract_summarize_plugin.mem0_search_extract_summarize_plugin.Mem0SearchExtractSummarizePlugin.mem0_search_extract_summarize" href="#frame.src.plugins.mem0_search_extract_summarize_plugin.mem0_search_extract_summarize_plugin.Mem0SearchExtractSummarizePlugin.mem0_search_extract_summarize">mem0_search_extract_summarize</a></code></li>
<li><code><a title="frame.src.plugins.mem0_search_extract_summarize_plugin.mem0_search_extract_summarize_plugin.Mem0SearchExtractSummarizePlugin.summarize" href="#frame.src.plugins.mem0_search_extract_summarize_plugin.mem0_search_extract_summarize_plugin.Mem0SearchExtractSummarizePlugin.summarize">summarize</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.1</a>.</p>
</footer>
</body>
</html>
